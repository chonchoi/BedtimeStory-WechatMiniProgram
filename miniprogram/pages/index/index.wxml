<!--index.wxml-->
<view class="container">
  <!-- 骨架屏 -->
  <view class="skeleton" wx:if="{{loading}}">
    <view class="skeleton-section">
      <view class="skeleton-title"></view>
      <view class="skeleton-grid">
        <view class="skeleton-item" wx:for="{{[1,2,3,4]}}" wx:key="*this"></view>
      </view>
    </view>
    <view class="skeleton-section">
      <view class="skeleton-title"></view>
      <view class="skeleton-grid">
        <view class="skeleton-item" wx:for="{{[1,2,3,4]}}" wx:key="*this"></view>
      </view>
    </view>
    <view class="skeleton-section">
      <view class="skeleton-title"></view>
      <view class="skeleton-grid">
        <view class="skeleton-item" wx:for="{{[1,2,3,4]}}" wx:key="*this"></view>
      </view>
    </view>
    <view class="skeleton-button"></view>
  </view>

  <!-- 主内容 -->
  <view class="main-content" wx:else>
    <view class="section">
      <view class="section-title">选择主角小动物</view>
      <view class="selection-grid">
        <view 
          wx:for="{{animals}}" 
          wx:key="id"
          class="selection-item {{selectedAnimal === item.id ? 'selected' : ''}}"
          bindtap="selectAnimal"
          data-id="{{item.id}}"
        >
          <text class="emoji">{{item.emoji}}</text>
          <text>{{item.name}}</text>
        </view>
      </view>
    </view>

    <view class="section" wx:if="{{selectedAnimal}}">
      <view class="section-title">选择故事发生的地点</view>
      <view class="selection-grid">
        <view 
          wx:for="{{scenes}}" 
          wx:key="id"
          class="selection-item {{selectedScene === item.id ? 'selected' : ''}}"
          bindtap="selectScene"
          data-id="{{item.id}}"
        >
          <text class="emoji">{{item.emoji}}</text>
          <text>{{item.name}}</text>
        </view>
      </view>
    </view>

    <view class="section" wx:if="{{selectedScene}}">
      <view class="section-title">选择故事的风格</view>
      <view class="selection-grid">
        <view 
          wx:for="{{styles}}" 
          wx:key="id"
          class="selection-item {{selectedStyle === item.id ? 'selected' : ''}}"
          bindtap="selectStyle"
          data-id="{{item.id}}"
        >
          <text class="emoji">{{item.emoji}}</text>
          <text>{{item.name}}</text>
        </view>
      </view>
    </view>

    <!-- 操作按钮 -->
    <view class="button-group" wx:if="{{selectedAnimal && selectedScene && selectedStyle}}">
      <button 
        class="generate-btn" 
        bindtap="goToStoryPage"
      >开始生成故事</button>
    </view>
  </view>
</view>